<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golf Day Insurance - GolfGuard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f9f0;
        }
        .hero-bg {
            background-image: url('https://images.unsplash.com/photo-1593491259871-bdd2a5ddd7e2');
            background-size: cover;
            background-position: center;
            position: relative;
        }
        .hero-overlay {
            background: linear-gradient(to right, rgba(240,249,240,0.9), rgba(240,249,240,0.7));
        }
        .gradient-bg {
            background: linear-gradient(135deg, #e6f3e6, #c2e3c2);
        }
        .quote-card {
            background-color: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0,128,0,0.2);
            box-shadow: 0 10px 30px rgba(0,128,0,0.1);
        }
        .loading-spinner {
            border-top-color: #38a169;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="antialiased">
    <header class="gradient-bg">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-green-800">GolfGuard</div>
            <div class="space-x-4">
                <a href="#" class="text-green-700 hover:text-green-900">Home</a>
                <a href="#" class="text-green-700 hover:text-green-900">About</a>
                <a href="#" class="text-green-700 hover:text-green-900">Services</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-16">
        <div class="hero-bg rounded-2xl overflow-hidden">
            <div class="hero-overlay">
                <div class="flex items-center">
                    <div class="w-1/2 pr-12 pl-12 py-16">
                        <h1 class="text-5xl font-bold text-green-900 mb-6">Golf Day Insurance</h1>
                        <p class="text-xl text-green-800 mb-8">
                            Protect your golf day from unpredictable weather. We'll reimburse you if the conditions ruin your round.
                        </p>
                        <ul class="mb-8 space-y-3 text-green-700">
                            <li class="flex items-center">
                                <svg class="w-6 h-6 mr-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Instant online quotes
                            </li>
                            <li class="flex items-center">
                                <svg class="w-6 h-6 mr-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Coverage for all Irish golf courses
                            </li>
                            <li class="flex items-center">
                                <svg class="w-6 h-6 mr-3 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Historical weather risk analysis
                            </li>
                        </ul>
                    </div>
                    <div class="w-1/2 pr-12">
                        <div class="quote-card p-8 rounded-lg shadow-xl">
                            <h2 class="text-3xl text-green-900 mb-6 text-center">Get Your Quote</h2>
                            
                            <div class="mb-4">
                                <label for="courseSearch" class="block text-green-800 mb-2">Search for a course:</label>
                                <input type="text" id="courseSearch" placeholder="Start typing to filter courses..." 
                                       class="w-full px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>

                            <div class="mb-4">
                                <label for="course" class="block text-green-800 mb-2">Choose your course:</label>
                                <select id="course" class="w-full px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <!-- Courses will be populated dynamically -->
                                </select>
                            </div>

                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="month" class="block text-green-800 mb-2">Choose a month:</label>
                                    <select id="month" class="w-full px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                        <!-- Months will be populated dynamically -->
                                    </select>
                                </div>
                                <div>
                                    <label for="day" class="block text-green-800 mb-2">Choose a day:</label>
                                    <select id="day" class="w-full px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                        <!-- Days will be populated dynamically -->
                                    </select>
                                </div>
                            </div>

                            <div class="mb-6">
                                <label for="hour" class="block text-green-800 mb-2">Tee time (hour):</label>
                                <select id="hour" class="w-full px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                    <!-- Hours will be populated dynamically -->
                                </select>
                            </div>

                            <button onclick="getQuote()" class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition duration-300">
                                Calculate Quote
                            </button>

                            <div id="quoteResult" class="mt-6 p-4 bg-green-50 rounded-md text-center relative min-h-[60px]">
                                Your quote will appear here
                                <div id="loadingSpinner" class="hidden absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                                    <div class="w-8 h-8 border-4 border-green-200 border-t-green-600 rounded-full loading-spinner"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Container for detailed analysis -->
        <div id="detailsContainer"></div>
    </main>

    <footer class="bg-green-50 py-8">
        <div class="container mx-auto px-6 text-center">
            <p class="text-green-800">¬© 2025 GolfGuard Insurance. All rights reserved.</p>
        </div>
    </footer>

    <!-- Purchase Modal -->
    <div id="purchaseModal" class="hidden fixed inset-0 modal-backdrop z-50 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 max-w-md mx-4">
            <h3 class="text-2xl font-bold text-green-900 mb-4">Coming Soon!</h3>
            <p class="text-gray-700 mb-6">
                We're working hard to bring you golf day weather insurance. Be the first to know when we launch!
            </p>
            <form id="emailForm" class="space-y-4">
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                    <input type="email" id="email" name="email" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                           placeholder="your@email.com">
                </div>
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-300">
                        Notify Me
                    </button>
                    <button type="button" onclick="closePurchaseModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 transition duration-300">
                        Cancel
                    </button>
                </div>
            </form>
            <div id="successMessage" class="hidden mt-4 p-4 bg-green-100 text-green-700 rounded-md">
                Thank you! We'll notify you when GolfGuard launches.
            </div>
        </div>
    </div>

    <script>
       const courses = {
    "Abbeyleix Golf Club": { lat: 52.9169, lon: -7.5028 },
    "Achill Island Golf Club": { lat: 53.9559, lon: -10.0572 },
    "Adare Golf Club": { lat: 52.5539, lon: -8.7972 },
    "Allen Park Golf Centre": { lat: 53.3864, lon: -6.3644 },
    "Ardeer Golf Club": { lat: 55.7039, lon: -4.7125 },
    "Ardglass Golf Club": { lat: 54.2858, lon: -5.4972 },
    "Ardminnan Golf Club": { lat: 54.3483, lon: -6.6528 },
    "Arklow Golf Club": { lat: 52.7942, lon: -6.1417 },
    "Ashbourne Golf Club": { lat: 53.5014, lon: -6.4228 },
    "Ashfield Golf Course": { lat: 54.5833, lon: -5.8333 },
    "Ashford Castle Golf Club": { lat: 53.5464, lon: -9.2944 },
    "Athenry Golf Club": { lat: 53.3008, lon: -8.7478 },
    "Athlone Golf Club": { lat: 53.4239, lon: -7.9407 },
    "Athy Golf Club": { lat: 52.9869, lon: -6.5892 },
    "Aughnacloy Golf Club": { lat: 54.4197, lon: -6.7553 },
    "Balbriggan Golf Club": { lat: 53.6114, lon: -6.1822 },
    "Balcarrick Golf Club": { lat: 53.4697, lon: -6.4331 },
    "Ballaghaderreen Golf Club": { lat: 53.9742, lon: -8.5928 },
    "Ballina Golf Club": { lat: 54.1153, lon: -9.1489 },
    "Ballinamore Golf Club": { lat: 54.0408, lon: -7.5714 },
    "Ballinascorney Golf Club": { lat: 53.2167, lon: -6.4833 },
    "Ballinasloe Golf Club": { lat: 53.3008, lon: -8.2214 },
    "Ballinlough Castle Golf Club": { lat: 53.5667, lon: -7.7833 },
    "Ballinrobe Golf Club": { lat: 53.6439, lon: -9.2272 },
    "Ballybofey & Stranorlar Golf Club": { lat: 54.8333, lon: -7.7833 },
    "Ballybunion - Cashen Course": { lat: 52.5047, lon: -9.8828 },
    "Ballybunion - Old Course": { lat: 52.5047, lon: -9.8828 },
    "Ballycastle Golf Club": { lat: 55.2056, lon: -6.2483 },
    "Ballyclare Golf Club": { lat: 54.75, lon: -6.0167 },
    "Ballyearl Golf Club": { lat: 54.6167, lon: -5.8333 },
    "Ballyhaunis Golf Club": { lat: 53.7667, lon: -8.8333 },
    "Ballyheigue Castle Golf Club": { lat: 52.2667, lon: -9.8833 },
    "Ballykisteen Golf & Country Club": { lat: 52.4833, lon: -8.2333 },
    "Ballyliffin - The Old Links": { lat: 55.2364, lon: -7.4617 },
    "Ballymena Golf Club": { lat: 54.8622, lon: -6.2524 },
    "Ballymoney Golf Club": { lat: 55.0667, lon: -6.5167 },
    "Ballyneety Golf Club": { lat: 52.5167, lon: -8.4333 },
    "Ballyreagh Golf Club": { lat: 55.1333, lon: -6.6667 },
    "Balmoral Golf Club": { lat: 54.5833, lon: -5.9333 },
    "Baltinglass Golf Club": { lat: 52.9064, lon: -6.5392 },
    "Banbridge Golf Club": { lat: 54.3481, lon: -6.2656 },
    "Bandon Golf Club": { lat: 51.75, lon: -8.7333 },
    "Bangor Golf Club": { lat: 54.6667, lon: -5.6667 },
    "Bantry Bay Golf Club": { lat: 51.6667, lon: -9.4333 },
    "Bearna Golf & Country Club": { lat: 53.2744, lon: -9.1056 },
    "Beaufort Golf Resort": { lat: 52.15, lon: -9.8833 },
    "Beaverstown Golf Club": { lat: 53.4333, lon: -6.1667 },
    "Beech Park Golf Club": { lat: 53.3083, lon: -6.35 },
    "Belturbet Golf Club": { lat: 54.2167, lon: -7.3333 },
    "Belvoir Park Golf Club": { lat: 54.5833, lon: -5.9 },
    "Benone Golf Club": { lat: 55.2167, lon: -6.9167 },
    "Berehaven Golf Club": { lat: 51.75, lon: -10.45 },
    "Birr Golf Club": { lat: 53.0917, lon: -7.8911 },
    "Black Bush - Black Bush Course": { lat: 53.5833, lon: -6.4667 },
    "Black Bush - Lagore Course": { lat: 53.5833, lon: -6.4667 },
    "Black Bush - Thomaston Course": { lat: 53.5833, lon: -6.4667 },
    "Blacklion Golf Club": { lat: 54.3203, lon: -7.6997 },
    "Blackwood - Hamilton Course": { lat: 54.5833, lon: -5.9333 },
    "Blackwood - Temple Course": { lat: 54.5833, lon: -5.9333 },
    "Blainroe Golf Club": { lat: 52.9167, lon: -6.0667 },
    "Blarney Golf Club": { lat: 51.9269, lon: -8.5436 },
    "Borris Golf Club": { lat: 52.7022, lon: -6.9333 },
    "Boyle Golf Club": { lat: 54.1833, lon: -8.3 },
    "Bray Golf Club": { lat: 53.2028, lon: -6.105 },
    "Bright Castle Golf Club": { lat: 54.3, lon: -6.35 },
    "Brown Trout Golf Club": { lat: 53.4, lon: -6.2667 },
    "Buncrana Golf Club": { lat: 55.1333, lon: -7.4667 },
    "Bundoran Golf Club": { lat: 54.4833, lon: -8.2833 },
    "Bushfoot Golf Club": { lat: 55.1333, lon: -6.6667 },
    "Cabra Castle Hotel": { lat: 53.8531, lon: -6.7981 },
    "Cahir Park Golf Club": { lat: 52.3747, lon: -7.9236 },
    "Cairndhu Golf Club": { lat: 55.05, lon: -5.8333 },
    "Callan Golf Club": { lat: 52.5333, lon: -7.2833 },
    "Carlow Golf Club": { lat: 52.8364, lon: -6.9256 },
    "Carnalea Golf Club": { lat: 54.65, lon: -5.7833 },
    "Carne Golf Links": { lat: 53.1, lon: -6.15 },
    "Carrick-on-Shannon Golf Club": { lat: 53.95, lon: -8.0833 },
    "Carrick-on-Suir Golf Club": { lat: 52.35, lon: -7.4167 },
    "Carrickfergus Golf Club": { lat: 54.7167, lon: -5.7667 },
    "Carrickmines Golf Club": { lat: 53.2667, lon: -6.2167 },
    "Carton House Golf Club": { lat: 53.4167, lon: -6.55 },
    "Castle Golf Club": { lat: 53.2667, lon: -6.2833 },
    "Castle Hume Golf Club": { lat: 54.35, lon: -7.65 },
    "Castlebar Golf Club": { lat: 53.9167, lon: -9.2833 },
    "Castlecomer Golf Club": { lat: 52.75, lon: -7.25 },
    "Castlegregory Golf Club": { lat: 52.25, lon: -9.95 },
    "Castleisland Golf Club": { lat: 52.2333, lon: -9.4833 },
    "Castlerea Golf Club": { lat: 53.7667, lon: -8.5 },
    "Castletroy Golf Club": { lat: 52.6639, lon: -8.6281 },
    "Castlewarden Golf Club": { lat: 53.3667, lon: -6.5167 },
    "Celbridge Elm Hall Golf Club": { lat: 53.3233, lon: -6.55 },
    "Charleville Golf Club": { lat: 52.3667, lon: -8.6667 },
    "Cill Dara Golf Club": { lat: 53.2167, lon: -6.65 },
    "City of Belfast Golf Club": { lat: 54.6167, lon: -5.85 },
    "City of Derry Golf Club": { lat: 54.9964, lon: -7.3197 },
    "City of Derry Golf Course": { lat: 54.9964, lon: -7.3197 },
    "Clandeboye - Ava Course": { lat: 54.65, lon: -5.65 },
    "Clandeboye - Dufferin Course": { lat: 54.65, lon: -5.65 },
    "Claremorris Golf Club": { lat: 53.7167, lon: -8.9833 },
    "Cliftonville Golf Club": { lat: 54.6167, lon: -5.9333 },
    "Clonakilty Golf Club": { lat: 51.6167, lon: -8.8667 },
    "Clones Golf Club": { lat: 54.2, lon: -7.2333 },
    "Clonmel Golf Club": { lat: 52.35, lon: -7.7 },
    "Clontarf Golf Club": { lat: 53.3667, lon: -6.2167 },
    "Cloverhill Golf Club": { lat: 53.35, lon: -6.3667 },
    "Cobh Golf Club": { lat: 51.85, lon: -8.2944 },
    "Concra Wood Golf & Country Club": { lat: 54.1833, lon: -6.45 },
    "Connemara Isles Golf Club": { lat: 53.35, lon: -9.8833 },
    "Coollattin Golf Club": { lat: 52.7833, lon: -6.2333 },
    "Coosheen Golf Club": { lat: 51.85, lon: -10.2167 },
    "Corballis Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Cork Golf Club": { lat: 51.8769, lon: -8.3969 },
    "Corrstown Golf Club": { lat: 53.4833, lon: -6.15 },
    "County Armagh Golf Club": { lat: 54.35, lon: -6.65 },
    "County Cavan Golf Club": { lat: 53.9833, lon: -7.3667 },
    "County Longford Golf Club": { lat: 53.7333, lon: -7.8 },
    "County Meath (Trim) Golf Club": { lat: 53.55, lon: -6.6833 },
    "County Sligo Golf Club": { lat: 54.2667, lon: -8.4667 },
    "County Tipperary Golf & Country Club": { lat: 52.4833, lon: -8.1667 },
    "Courtown Golf Club": { lat: 52.6833, lon: -6.1667 },
    "Craddockstown Golf Club": { lat: 53.2, lon: -6.55 },
    "Crossgar Golf Club": { lat: 54.3667, lon: -5.75 },
    "Cruit Island Golf Club": { lat: 54.9167, lon: -8.35 },
    "Curragh Golf Club": { lat: 53.15, lon: -6.85 },
    "Cushendall Golf Club": { lat: 55.1167, lon: -6.0333 },
    "Deer Park - Main Course": { lat: 53.2667, lon: -6.2167 },
    "Deer Park - St Fintan's": { lat: 53.2667, lon: -6.2167 },
    "Delgany Golf Club": { lat: 53.15, lon: -6.1 },
    "Dingle (Ceann Sibeal) Golf Club": { lat: 52.1333, lon: -10.2667 },
    "Djouce Mountain Golf Club": { lat: 53.15, lon: -6.15 },
    "Donabate Golf Club": { lat: 53.45, lon: -6.15 },
    "Donaghadee Golf Club": { lat: 54.6167, lon: -5.55 },
    "Donegal Golf Club": { lat: 54.9667, lon: -8.3 },
    "Doneraile Golf Club": { lat: 52.25, lon: -8.3667 },
    "Dooks Golf Club": { lat: 52.15, lon: -9.9 },
    "Douglas Golf Club": { lat: 51.8833, lon: -8.4167 },
    "Downpatrick Golf Club": { lat: 54.3333, lon: -5.7167 },
    "Dromoland Castle Golf Club": { lat: 52.8667, lon: -8.9333 },
    "Druids Glen Golf Club": { lat: 53.0167, lon: -6.0833 },
    "Dublin Mountain Golf Club": { lat: 53.25, lon: -6.2667 },
    "Dun Lagohaire Golf Club": { lat: 53.2833, lon: -6.1333 },
    "Dundalk Golf Club": { lat: 53.9833, lon: -6.4167 },
    "Dunfanaghy Golf Club": { lat: 55.2167, lon: -7.95 },
    "Dungannon Golf Club": { lat: 54.5, lon: -6.7667 },
    "Dungarvan Golf Club": { lat: 52.0833, lon: -7.6167 },
    "Dunloe Golf Club": { lat: 52.1, lon: -9.6333 },
    "Dunmore Demesne Golf Club": { lat: 52.45, lon: -7.1 },
    "Dunmore East Golf Club": { lat: 52.15, lon: -7.1167 },
    "Dunmurry Golf Club": { lat: 54.5333, lon: -5.95 },
    "East Clare Golf Club": { lat: 52.7833, lon: -8.55 },
    "East Cork Golf Club": { lat: 51.9167, lon: -8.1667 },
    "Edenderry Golf Club": { lat: 53.3333, lon: -6.9667 },
    "Edenmore Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Elm Park Golf Club": { lat: 53.2667, lon: -6.2167 },
    "Elmgreen Golf Club": { lat: 53.35, lon: -6.2667 },
    "Ennis Golf Club": { lat: 52.85, lon: -8.9833 },
    "Enniscorthy Golf Club": { lat: 52.5, lon: -6.5667 },
    "Enniscrone Golf Club": { lat: 54.3167, lon: -9.1 },
    "Enniskillen Golf Club": { lat: 54.35, lon: -7.6333 },
    "Esker Hills Golf Club": { lat: 53.15, lon: -7.2 },
    "Faithlegg Golf Club": { lat: 52.15, lon: -7.1167 },
    "Fermoy Golf Club": { lat: 52.2833, lon: -8.2667 },
    "Fernhill Golf Club": { lat: 53.2667, lon: -6.2167 },
    "Fintona Golf Club": { lat: 54.5, lon: -7.35 },
    "Forest Little Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Fortwilliam Golf Club": { lat: 54.6167, lon: -5.9333 },
    "Fota Island Golf Club": { lat: 51.85, lon: -8.3 },
    "Foxrock Golf Club": { lat: 53.2833, lon: -6.2167 },
    "Foyle International Golf Centre - Championship": { lat: 54.9964, lon: -7.3197 },
    "Foyle International Golf Centre - Woodlands": { lat: 54.9964, lon: -7.3197 },
    "Frankfield Golf Club": { lat: 53.2833, lon: -6.2167 },
    "Galgorm Castle Golf Club": { lat: 54.85, lon: -6.4333 },
    "Galway Bay Golf & Country Club": { lat: 53.2667, lon: -9.0667 },
    "Galway Golf Club": { lat: 53.3, lon: -9.0833 },
    "Gilnahirk Golf Club": { lat: 54.5833, lon: -5.9 },
    "Glasson Golf Club": { lat: 53.4833, lon: -7.8167 },
    "Glencullen Golf Club": { lat: 53.25, lon: -6.3 },
    "Glengarriff Golf Club": { lat: 51.75, lon: -9.5333 },
    "Glenlo Abbey Golf Club": { lat: 53.3, lon: -9.0667 },
    "Gold Coast Golf Club": { lat: 52.45, lon: -6.9667 },
    "Gort Golf Club": { lat: 52.8667, lon: -8.8167 },
    "Gowran Park Golf Club": { lat: 52.55, lon: -7.15 },
    "Gracehill Golf Club": { lat: 54.85, lon: -6.35 },
    "Grange Castle Golf Club": { lat: 53.3167, lon: -6.3667 },
    "Grange Golf Club": { lat: 53.2833, lon: -6.2167 },
    "Greenacres Golf Centre": { lat: 53.4167, lon: -6.2167 },
    "Greencastle Golf Club": { lat: 55.2, lon: -6.85 },
    "Greenisland Golf Club": { lat: 54.6667, lon: -5.75 },
    "Greenore Golf Club": { lat: 54.0333, lon: -6.1667 },
    "Greystones Golf Club": { lat: 53.15, lon: -6.1 },
    "Gweedore Golf Club": { lat: 54.95, lon: -8.3 },
    "Headfort Golf Club - Championship Course": { lat: 53.7167, lon: -6.65 },
    "Headfort Golf Club - Old Course": { lat: 53.7167, lon: -6.65 },
    "Helen's Bay Golf Club": { lat: 54.6167, lon: -5.55 },
    "Hermitage Golf Club": { lat: 53.3667, lon: -6.35 },
    "Highfield Golf Club": { lat: 54.6167, lon: -5.9333 },
    "Hilton Belfast Templepatrick Golf & Country Club": { lat: 54.65, lon: -6.1167 },
    "Hollywood Lakes Golf Club": { lat: 54.2, lon: -5.7333 },
    "Holywood Golf Club": { lat: 54.6333, lon: -5.75 },
    "Howth Golf Club": { lat: 53.3833, lon: -6.0667 },
    "Kanturk Golf Club": { lat: 52.25, lon: -8.9667 },
    "Kenmare Golf Club": { lat: 51.8833, lon: -9.5833 },
    "Kilcock Golf Club": { lat: 53.3833, lon: -6.65 },
    "Kilkea Castle Golf Club": { lat: 52.9167, lon: -6.8333 },
    "Kilkee Golf Club": { lat: 52.65, lon: -9.4833 },
    "Kilkeel Golf Club": { lat: 54.2333, lon: -5.9667 },
    "Kilkenny Golf Club": { lat: 52.65, lon: -7.25 },
    "Killarney - Killeen Course": { lat: 52.1, lon: -9.5167 },
    "Killarney - Mahony's Point Course": { lat: 52.1, lon: -9.5167 },
    "Killarney Golf & Fishing Club ÔøΩ Academy Course": { lat: 52.1, lon: -9.5167 },
    "Killeen Golf Club": { lat: 53.25, lon: -6.55 },
    "Killerig Castle Golf Club": { lat: 52.8333, lon: -6.75 },
    "Killin Park Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Killiney Golf Club": { lat: 53.2667, lon: -6.1167 },
    "Killorglin Golf Club": { lat: 52.1, lon: -9.5 },
    "Killymoon Golf Club": { lat: 54.5, lon: -6.7667 },
    "Kilmashogue Golf Club": { lat: 53.2833, lon: -6.2833 },
    "Kilrea Golf Club": { lat: 54.9667, lon: -6.65 },
    "Kilrush Golf Club": { lat: 52.6, lon: -9.4833 },
    "Kilternan Golf Club": { lat: 53.25, lon: -6.25 },
    "Kinsale Golf Club": { lat: 51.7083, lon: -8.5222 },
    "Kirkistown Castle Golf Club": { lat: 54.4, lon: -5.5333 },
    "Knightsbrook Golf Club": { lat: 53.4167, lon: -6.55 },
    "Knock Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Lahinch - Castle Course": { lat: 52.9333, lon: -9.4 },
    "Lahinch - Old Course": { lat: 52.9333, lon: -9.4 },
    "Lambeg Golf Club": { lat: 54.55, lon: -5.95 },
    "Larne Golf Club": { lat: 55, lon: -5.8167 },
    "Laytown & Bettystown Golf Club": { lat: 53.6833, lon: -6.2167 },
    "Lee Valley Golf & Country Club": { lat: 52.1667, lon: -8.5333 },
    "Leopardstown Golf Club": { lat: 53.2833, lon: -6.2167 },
    "Letterkenny Golf Club": { lat: 54.95, lon: -7.7333 },
    "Limerick Golf Club": { lat: 52.6667, lon: -8.6333 },
    "Lisburn Golf Club": { lat: 54.5167, lon: -6.0333 },
    "Lismore Golf Club": { lat: 52.15, lon: -8.0333 },
    "Listowel Golf Club": { lat: 52.45, lon: -9.4833 },
    "Loughgall Country Park & golf course": { lat: 54.35, lon: -6.55 },
    "Loughrea Golf Club": { lat: 53.05, lon: -8.5667 },
    "Lucan Golf Club": { lat: 53.3667, lon: -6.45 },
    "Lurgan Golf Club": { lat: 54.45, lon: -6.35 },
    "Luttrellstown Castle Golf Club": { lat: 53.4167, lon: -6.4 },
    "Macroom Golf Club": { lat: 51.9167, lon: -8.9667 },
    "Mahee Island Golf Club": { lat: 54.55, lon: -5.6333 },
    "Mahon Golf Club": { lat: 51.8667, lon: -8.4167 },
    "Malahide Golf Club": { lat: 53.45, lon: -6.15 },
    "Mallow Golf Club": { lat: 52.15, lon: -8.65 },
    "Malone Edenderry Course": { lat: 54.5833, lon: -5.9333 },
    "Malone Golf Club": { lat: 54.5833, lon: -5.9333 },
    "Mannan Castle Golf Club": { lat: 53.4167, lon: -6.55 },
    "Manor Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Massereene Golf Club": { lat: 54.6167, lon: -6.25 },
    "Milltown Golf Club": { lat: 53.2833, lon: -6.2167 },
    "Mitchelstown Golf Club": { lat: 52.2667, lon: -8.2667 },
    "Moate Golf Club": { lat: 53.3167, lon: -7.7167 },
    "Monkstown Golf Club": { lat: 51.85, lon: -8.35 },
    "Mount Juliet Golf & Country Club": { lat: 52.5, lon: -7.25 },
    "Mount Temple Golf Club": { lat: 53.4167, lon: -6.45 },
    "Mount Wolseley Golf Hotel & Country Club": { lat: 52.9167, lon: -6.7333 },
    "Mountain View Golf Club": { lat: 53.25, lon: -6.3 },
    "Mountbellew Golf Club": { lat: 53.4833, lon: -8.4667 },
    "Mountrath Golf Club": { lat: 52.8, lon: -7.4333 },
    "Mourne Golf Club": { lat: 54.2333, lon: -5.9667 },
    "Moyola Park Golf Club": { lat: 54.75, lon: -6.65 },
    "Moyvalley Golf Club": { lat: 53.35, lon: -6.65 },
    "Mullingar Golf Club": { lat: 53.5333, lon: -7.35 },
    "Mulranny Golf Club": { lat: 53.9, lon: -9.9167 },
    "Muskerry Golf Club": { lat: 51.9333, lon: -8.65 },
    "Naas Golf Club": { lat: 53.2167, lon: -6.65 },
    "Narin & Portnoo Golf Club": { lat: 54.9333, lon: -8.35 },
    "Nenagh Golf Club": { lat: 52.8667, lon: -8.2 },
    "New Ross Golf Club": { lat: 52.4, lon: -6.9333 },
    "Newbridge Golf Club": { lat: 53.3333, lon: -6.65 },
    "Newcastle West Golf Club": { lat: 52.45, lon: -9.2667 },
    "Newlands Golf Club": { lat: 53.2833, lon: -6.2167 },
    "Newtownstewart Golf Club": { lat: 54.7, lon: -7.35 },
    "Newtownstewart Golf Club": { lat: 54.7, lon: -7.35 },
    "North West Golf Club": { lat: 54.9667, lon: -7.3333 },
    "Nuremore Hotel Golf & Country Club": { lat: 54.1833, lon: -6.45 },
    "Old Conna Golf Club": { lat: 53.2667, lon: -6.2167 },
    "Old Conna Golf Club": { lat: 53.2667, lon: -6.2167 },
    "Old Head of Kinsale Golf Club": { lat: 51.6167, lon: -8.5333 },
    "Old Head of Kinsale Golf Club": { lat: 51.6167, lon: -8.5333 },
    "Omagh Golf Club": { lat: 54.6, lon: -7.3 },
    "Omagh Golf Club": { lat: 54.6, lon: -7.3 },
    "Otway Golf Club": { lat: 54.5, lon: -6.7667 },
    "Otway Golf Club": { lat: 54.5, lon: -6.7667 },
    "Oughterard Golf Club": { lat: 53.4833, lon: -9.2833 },
    "Oughterard Golf Club": { lat: 53.4833, lon: -9.2833 },
    "Palmerstown House Golf Club": { lat: 53.35, lon: -6.55 },
    "Palmerstown House Golf Club": { lat: 53.35, lon: -6.55 },
    "Parknasilla Golf Club": { lat: 51.9, lon: -10.2 },
    "Parknasilla Golf Club": { lat: 51.9, lon: -10.2 },
    "Portadown Golf Club": { lat: 54.4167, lon: -6.4167 },
    "Portadown Golf Club": { lat: 54.4167, lon: -6.4167 },
    "Portarlington Golf Club": { lat: 53.1667, lon: -7.1833 },
    "Portarlington Golf Club": { lat: 53.1667, lon: -7.1833 },
    "Portmarnock Championship Course": { lat: 53.45, lon: -6.15 },
    "Portmarnock Championship Course": { lat: 53.45, lon: -6.15 },
    "Portmarnock Hotel & Golf Links": { lat: 53.45, lon: -6.15 },
    "Portmarnock Hotel & Golf Links": { lat: 53.45, lon: -6.15 },
    "Portsalon Golf Club": { lat: 55.2167, lon: -7.55 },
    "Portsalon Golf Club": { lat: 55.2167, lon: -7.55 },
    "Portstewart - Old Course": { lat: 55.1333, lon: -6.9 },
    "Portstewart - Old Course": { lat: 55.1333, lon: -6.9 },
    "Portstewart - Riverside Golf Club": { lat: 55.1333, lon: -6.9 },
    "Portstewart - Riverside Golf Club": { lat: 55.1333, lon: -6.9 },
    "Portstewart - Strand Golf Club": { lat: 55.1333, lon: -6.9 },
    "Portstewart - Strand Golf Club": { lat: 55.1333, lon: -6.9 },
    "Portumna Golf Club": { lat: 53.0833, lon: -8.25 },
    "Portumna Golf Club": { lat: 53.0833, lon: -8.25 },
    "Powerscourt Golf Club": { lat: 53.15, lon: -6.15 },
    "Powerscourt Golf Club": { lat: 53.15, lon: -6.15 },
    "R and R Golf Course": { lat: 53.4167, lon: -6.2167 },
    "R and R Golf Course": { lat: 53.4167, lon: -6.2167 },
    "Raffeen Creek Golf Club": { lat: 51.85, lon: -8.35 },
    "Rathbane Golf Club": { lat: 52.6667, lon: -8.6333 },
    "Rathdowney Golf Club": { lat: 52.7833, lon: -7.6 },
    "Rathfarnham Golf Club": { lat: 53.2833, lon: -6.2833 },
    "Rathmore Golf Club": { lat: 52.55, lon: -7.85 },
    "Rathsallagh Golf Club": { lat: 52.9167, lon: -6.55 },
    "Redcastle Hotel & Golf Club": { lat: 54.65, lon: -6.1167 },
    "Ring of Kerry Golf Club": { lat: 51.95, lon: -10.15 },
    "Rockmount Golf Club": { lat: 51.85, lon: -8.35 },
    "Rockmount Golf Club": { lat: 51.85, lon: -8.3 },
    "Roe Park Resort": { lat: 54.9667, lon: -7.3333 },
    "Roganstown Hotel & CC": { lat: 53.4833, lon: -6.2 },
    "Rosapenna Golf Club": { lat: 55.15, lon: -7.85 },
    "Roscommon Golf Club": { lat: 53.6333, lon: -8.2 },
    "Roscrea Golf Club": { lat: 52.95, lon: -7.9 },
    "Ross Golf Club": { lat: 52.45, lon: -9.2667 },
    "Rosslare Golf Club": { lat: 52.3, lon: -6.35 },
    "Rossmore Golf Club": { lat: 54.1833, lon: -6.45 },
    "Roundwood Golf Club": { lat: 53.1167, lon: -6.1667 },
    "Royal Belfast Golf Club": { lat: 54.6167, lon: -5.85 },
    "Royal County Down - Annesley Links": { lat: 54.2, lon: -5.9 },
    "Royal County Down - Championship Course": { lat: 54.2, lon: -5.9 },
    "Royal Dublin Golf Club": { lat: 53.35, lon: -6.15 },
    "Royal Portrush - Dunluce Links": { lat: 55.2, lon: -6.85 },
    "Royal Portrush - Valley Links": { lat: 55.2, lon: -6.85 },
    "Royal Tara Golf Club": { lat: 53.55, lon: -6.6833 },
    "Rush Golf Club": { lat: 53.5167, lon: -6.1 },
    "Scrabo Golf Club": { lat: 54.6, lon: -5.7 },
    "Seapoint Golf Links": { lat: 53.7, lon: -6.25 },
    "Shandon Park Golf Club": { lat: 54.6167, lon: -5.9333 },
    "Shannon Golf Club": { lat: 52.7, lon: -8.9167 },
    "Silverwood Golf Centre": { lat: 54.3333, lon: -6.35 },
    "Skellig Bay Golf Club": { lat: 52.1, lon: -10.2667 },
    "Skerries Golf Club": { lat: 53.5833, lon: -6.1167 },
    "Skibbereen and West Carbery Golf Club": { lat: 51.7, lon: -9.45 },
    "Slieve Russell Golf Club": { lat: 53.95, lon: -7.9167 },
    "Slievenamon Golf Club": { lat: 52.4667, lon: -7.3833 },
    "South County Golf Club": { lat: 53.2833, lon: -6.2167 },
    "South Meath Golf Club": { lat: 53.55, lon: -6.6833 },
    "Spa Golf Club": { lat: 54.6167, lon: -5.85 },
    "Spanish Point Golf Club": { lat: 52.9, lon: -9.45 },
    "St Anne's Golf Club": { lat: 53.35, lon: -6.15 },
    "St Helen's Bay Golf Club": { lat: 54.6167, lon: -5.55 },
    "St Margaret's Golf Club": { lat: 53.4167, lon: -6.2167 },
    "St Patricks Links Golf Club": { lat: 55.15, lon: -7.45 },
    "Stackstown Golf Club": { lat: 53.2833, lon: -6.2833 },
    "Stepaside Golf Club": { lat: 53.2667, lon: -6.25 },
    "Strabane Golf Club": { lat: 54.8333, lon: -7.4667 },
    "Strandhill Golf Club": { lat: 54.2667, lon: -8.6 },
    "Strokestown Golf Club": { lat: 53.8167, lon: -8.1833 },
    "Summerhill Golf Club": { lat: 53.55, lon: -6.6833 },
    "Sutton Golf Club": { lat: 53.3833, lon: -6.1167 },
    "Swinford Golf Club": { lat: 53.95, lon: -8.9667 },
    "Swords Open Golf Club": { lat: 53.45, lon: -6.2167 },
    "Tandragee Golf Club": { lat: 54.35, lon: -6.45 },
    "Tara Glen Golf Club": { lat: 53.4167, lon: -6.45 },
    "Temple Golf Club": { lat: 53.2833, lon: -6.2167 },
    "Templemore Golf Club": { lat: 52.7667, lon: -7.95 },
    "The European Club": { lat: 52.95, lon: -6.1 },
    "The Heath Golf Club": { lat: 53.15, lon: -7.3 },
    "The Heritage Golf Resort": { lat: 53.4167, lon: -6.55 },
    "The Island Golf Club": { lat: 53.4167, lon: -6.15 },
    "The K Club": { lat: 53.3167, lon: -6.55 },
    "Thurles Golf Club": { lat: 52.5167, lon: -7.85 },
    "Tipperary Golf Club": { lat: 52.4667, lon: -8.1667 },
    "Traad Ponds Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Tralee Golf Club": { lat: 52.2667, lon: -9.7 },
    "Tramore Golf Club": { lat: 52.15, lon: -7.1167 },
    "Trump International Golf Links & Hotel Doonbeg": { lat: 52.8333, lon: -9.4167 },
    "Tuam Golf Club": { lat: 53.5167, lon: -8.85 },
    "Tubbercurry Golf Club": { lat: 54.2333, lon: -8.4167 },
    "Tulfarris Golf Club": { lat: 53.15, lon: -6.55 },
    "Tullamore Golf Club": { lat: 53.2833, lon: -7.4833 },
    "Virginia Golf Club": { lat: 53.75, lon: -7.0167 },
    "Warrenpoint Golf Club": { lat: 54.1833, lon: -6.25 },
    "Waterford Castle Golf Club": { lat: 52.25, lon: -7.1 },
    "Waterford Golf Club": { lat: 52.2667, lon: -7.1167 },
    "Waterville Golf Links": { lat: 51.7833, lon: -10.05 },
    "West Waterford Golf Club": { lat: 52.15, lon: -7.7167 },
    "Westmanstown Golf Club": { lat: 53.4167, lon: -6.2167 },
    "Westport Golf Club": { lat: 53.8167, lon: -9.5167 },
    "Wexford Golf Club": { lat: 52.3333, lon: -6.4667 },
    "Whitehead Golf Club": { lat: 54.7, lon: -5.75 },
    "Wicklow Golf Club": { lat: 53.0167, lon: -6.0333 },
    "Williamstown Golf Club": { lat: 52.45, lon: -9.2667 },
    "Woodbrook Golf Club": { lat: 53.2667, lon: -6.15 },
    "Woodenbridge Golf Club": { lat: 52.9167, lon: -6.25 },
    "Youghal Golf Club": { lat: 51.95, lon: -8.2167 }
};

        const courseSelect = document.getElementById("course");
        const courseSearch = document.getElementById("courseSearch");
        const monthSelect = document.getElementById("month");
        const daySelect = document.getElementById("day");
        const hourSelect = document.getElementById("hour");
        const quoteResult = document.getElementById("quoteResult");
        const loadingSpinner = document.getElementById("loadingSpinner");
        const detailsContainer = document.getElementById("detailsContainer");

        function round(val, digits = 1) {
            return Math.round(val * 10 ** digits) / 10 ** digits;
        }

        function populateCourses(filter = "") {
            courseSelect.innerHTML = '';
            Object.keys(courses).forEach(name => {
                if (name.toLowerCase().includes(filter.toLowerCase())) {
                    const option = document.createElement("option");
                    option.value = name;
                    option.text = name;
                    courseSelect.appendChild(option);
                }
            });
        }

        courseSearch.addEventListener("input", () => {
            populateCourses(courseSearch.value);
        });

        // Populate months
        for (let i = 0; i < 12; i++) {
            const opt = document.createElement("option");
            opt.value = (i + 1).toString().padStart(2, '0');
            opt.text = new Date(0, i).toLocaleString('default', { month: 'long' });
            monthSelect.appendChild(opt);
        }

        // Populate days
        for (let i = 1; i <= 31; i++) {
            const opt = document.createElement("option");
            opt.value = i.toString().padStart(2, '0');
            opt.text = i;
            daySelect.appendChild(opt);
        }

        // Populate hours
        for (let i = 7; i <= 21; i++) {
            const opt = document.createElement("option");
            opt.value = i.toString().padStart(2, '0');
            opt.text = `${i}:00`;
            hourSelect.appendChild(opt);
        }

        function calculateWeatherScore(temp, rain, wind) {
            // Ideal conditions
            const idealTemp = 21; // 21¬∞C
            const idealRain = 0; // No rain
            const idealWind = 5; // Light breeze

            // Calculate penalties
            const tempPenalty = Math.min(Math.abs(temp - idealTemp) * 1.5, 30);
            const rainPenalty = Math.min(rain * 10, 50);
            const windPenalty = Math.min(Math.abs(wind - idealWind) * 2, 40);

            // Calculate overall score
            const score = 100 - (tempPenalty + rainPenalty + windPenalty);
            return Math.max(0, Math.min(100, score));
        }

        async function getQuote() {
            // Clear any previous details
            detailsContainer.innerHTML = '';
            
            // Show loading spinner with fun messages
            const loadingMessages = [
                "Polishing our balls...",
                "Teeing up our shot...",
                "Testing our swing...",
                "Checking the wind direction...",
                "Inspecting the greens...",
                "Calibrating our clubs...",
                "Reading the fairway...",
                "Analyzing the rough...",
                "Measuring the bunkers...",
                "Calculating your slice..."
            ];
            
            let messageIndex = 0;
            quoteResult.innerHTML = `
                <div class="text-green-700">
                    <div class="mb-2" id="loadingMessage">${loadingMessages[messageIndex]}</div>
                    <div class="w-8 h-8 border-4 border-green-200 border-t-green-600 rounded-full loading-spinner mx-auto"></div>
                </div>
            `;
            
            // Cycle through loading messages
            const messageInterval = setInterval(() => {
                messageIndex = (messageIndex + 1) % loadingMessages.length;
                const loadingMessageEl = document.getElementById('loadingMessage');
                if (loadingMessageEl) {
                    loadingMessageEl.textContent = loadingMessages[messageIndex];
                }
            }, 2000);

            const course = courseSelect.value;
            const { lat, lon } = courses[course];
            const month = monthSelect.value;
            const day = daySelect.value;
            const hour = hourSelect.value;

            const weatherData = [];
            const promises = [];

            // Fetch historical data for multiple years
            for (let year = 1979; year <= 2024; year++) {
                const date = new Date(year, parseInt(month) - 1, parseInt(day));
                const yyyy = date.getFullYear();
                const mm = (date.getMonth() + 1).toString().padStart(2, '0');
                const dd = date.getDate().toString().padStart(2, '0');
                const fullDate = `${yyyy}-${mm}-${dd}`;
                
                const url = `https://archive-api.open-meteo.com/v1/archive?latitude=${lat}&longitude=${lon}&start_date=${fullDate}&end_date=${fullDate}&hourly=temperature_2m,precipitation,windspeed_10m&timezone=Europe%2FDublin`;

                const p = fetch(url)
                    .then(res => res.json())
                    .then(data => {
                        const i = data.hourly.time.findIndex(t => t.includes(`T${hour}:00`));
                        if (i !== -1) {
                            const temp = data.hourly.temperature_2m[i];
                            const rain = data.hourly.precipitation[i];
                            const wind = data.hourly.windspeed_10m[i];

                            const score = calculateWeatherScore(temp, rain, wind);
                            weatherData.push({
                                year,
                                temp,
                                rain,
                                wind,
                                score
                            });
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching weather data:', error);
                    });
                
                promises.push(p);
            }

            try {
                await Promise.all(promises);

                // Clear the loading message interval
                clearInterval(messageInterval);

                if (weatherData.length === 0) {
                    quoteResult.innerHTML = `
                        <div class="text-red-600">
                            No weather data available for ${course} on ${month}-${day} @ ${hour}:00.
                        </div>
                    `;
                    return;
                }

                // Analyze weather data
                const badWeatherThreshold = 55;
                const badWeatherDays = weatherData.filter(day => day.score < badWeatherThreshold);
                const chanceOfBadWeather = (badWeatherDays.length / weatherData.length) * 100;

                // Pricing model
                const baseRate = 500; // ‚Ç¨500 payout
                const riskMultiplier = 2; // Margin for risk and administration
                const seasonalAdjustment = (parseInt(month) >= 11 || parseInt(month) <= 3) ? 1.5 : 1;
                
                const premium = Math.max(10, Math.ceil(
                    (chanceOfBadWeather / 100) * baseRate * riskMultiplier * seasonalAdjustment
                ));

                // Calculate averages
                const avgTemp = weatherData.reduce((sum, day) => sum + day.temp, 0) / weatherData.length;
                const avgRain = weatherData.reduce((sum, day) => sum + day.rain, 0) / weatherData.length;
                const avgWind = weatherData.reduce((sum, day) => sum + day.wind, 0) / weatherData.length;

                // Check if premium is too high
                if (premium > 200) {
                    quoteResult.innerHTML = `
                        <div class="text-amber-700">
                            <p class="font-bold mb-2 text-lg">Sorry, we can't offer insurance for ${course}</p>
                            <p class="mb-2">Date: ${month}-${day} @ ${hour}:00</p>
                            
                            <div class="mt-4 bg-amber-50 p-4 rounded">
                                <p class="mb-2">With a <span class="font-bold">${round(chanceOfBadWeather)}%</span> chance of bad weather, the risk is just too high for us to offer affordable coverage.</p>
                                <p class="font-semibold text-amber-800">But we believe in you! üèåÔ∏è</p>
                                <p class="text-sm mt-2">Pack your rain gear and embrace the elements. Some of golf's greatest stories happen in challenging conditions!</p>
                                
                                <div class="mt-4 bg-amber-100 p-3 rounded">
                                    <p class="font-semibold mb-1 text-amber-900">Weather Risk Analysis:</p>
                                    <ul class="list-disc list-inside text-sm">
                                        <li>Bad Weather Probability: <span class="font-bold">${round(chanceOfBadWeather)}%</span></li>
                                        <li>Avg. Temperature: ${round(avgTemp, 1)}¬∞C</li>
                                        <li>Avg. Rainfall: ${round(avgRain, 2)} mm</li>
                                        <li>Avg. Wind Speed: ${round(avgWind, 1)} km/h</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    quoteResult.innerHTML = `
                        <div class="text-green-900">
                            <p class="font-bold mb-2">Quote for ${course}</p>
                            <p>Date: ${month}-${day} @ ${hour}:00</p>
                            
                            <div class="mt-4 bg-green-50 p-3 rounded">
                                <p class="font-semibold mb-1">Weather Risk Analysis:</p>
                                <ul class="list-disc list-inside text-sm">
                                    <li>Bad Weather Probability: <span class="font-bold">${round(chanceOfBadWeather)}%</span></li>
                                    <li>Avg. Temperature: ${round(avgTemp, 1)}¬∞C</li>
                                    <li>Avg. Rainfall: ${round(avgRain, 2)} mm</li>
                                    <li>Avg. Wind Speed: ${round(avgWind, 1)} km/h</li>
                                </ul>
                            </div>

                            <p class="text-xl font-bold text-green-700 mt-4">Premium: ‚Ç¨${premium}</p>
                            <small class="text-green-600 block mt-2">Guaranteed ‚Ç¨500 payout if weather is unsuitable</small>
                            
                            <button onclick="showPurchaseModal()" class="mt-4 w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-300">
                                Buy Insurance
                            </button>
                        </div>
                    `;
                }

                // Add detailed analysis for ALL quotes (including high-risk ones)
                // Calculate mean and median scores
                const sortedScores = weatherData.map(d => d.score).sort((a, b) => a - b);
                const meanScore = weatherData.reduce((sum, d) => sum + d.score, 0) / weatherData.length;
                const medianScore = sortedScores.length % 2 === 0
                    ? (sortedScores[sortedScores.length / 2 - 1] + sortedScores[sortedScores.length / 2]) / 2
                    : sortedScores[Math.floor(sortedScores.length / 2)];

                // Sort weather data by score to get best and worst years
                const sortedWeatherData = [...weatherData].sort((a, b) => a.score - b.score);
                const worst5Years = sortedWeatherData.slice(0, 5);
                const best5Years = sortedWeatherData.slice(-5).reverse();

                detailsContainer.innerHTML = `
                    <div class="mt-8 p-6 bg-white rounded-lg shadow-md border border-green-200">
                        <h3 class="text-xl font-bold text-green-900 mb-4">Detailed Historical Analysis</h3>
                        
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-green-50 p-4 rounded">
                                <p class="font-semibold text-green-800">Mean Weather Score</p>
                                <p class="text-2xl font-bold text-green-700">${round(meanScore, 1)}</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded">
                                <p class="font-semibold text-green-800">Median Weather Score</p>
                                <p class="text-2xl font-bold text-green-700">${round(medianScore, 1)}</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold text-red-700 mb-2">5 Worst Weather Years</h4>
                                <div class="space-y-2">
                                    ${worst5Years.map(data => `
                                        <div class="bg-red-50 p-2 rounded text-sm">
                                            <span class="font-semibold">${data.year}:</span> 
                                            Score ${round(data.score, 1)} 
                                            <span class="text-xs text-gray-600">
                                                (${round(data.temp, 1)}¬∞C, ${round(data.rain, 1)}mm rain, ${round(data.wind, 1)}km/h wind)
                                            </span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold text-green-700 mb-2">5 Best Weather Years</h4>
                                <div class="space-y-2">
                                    ${best5Years.map(data => `
                                        <div class="bg-green-50 p-2 rounded text-sm">
                                            <span class="font-semibold">${data.year}:</span> 
                                            Score ${round(data.score, 1)}
                                            <span class="text-xs text-gray-600">
                                                (${round(data.temp, 1)}¬∞C, ${round(data.rain, 1)}mm rain, ${round(data.wind, 1)}km/h wind)
                                            </span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 text-sm text-gray-600">
                            <p><strong>Note:</strong> Weather scores range from 0-100. Scores below 55 trigger insurance payout.</p>
                            <p>Based on ${weatherData.length} years of historical data (1979-2024).</p>
                        </div>
                    </div>
                `;
            } catch (error) {
                // Clear the loading message interval
                clearInterval(messageInterval);

                quoteResult.innerHTML = `
                    <div class="text-red-600">
                        Error calculating quote. Please try again later.
                        <br>
                        <small>${error.message}</small>
                    </div>
                `;
            }
        }

        // Modal functions
        function showPurchaseModal() {
            document.getElementById('purchaseModal').classList.remove('hidden');
        }

        function closePurchaseModal() {
            document.getElementById('purchaseModal').classList.add('hidden');
            document.getElementById('emailForm').reset();
            document.getElementById('successMessage').classList.add('hidden');
        }

        // Email form submission
        document.getElementById('emailForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            
            // In a real application, you would send this to your backend
            console.log('Email submitted:', email);
            
            // Show success message
            document.getElementById('successMessage').classList.remove('hidden');
            document.getElementById('emailForm').style.display = 'none';
            
            // Close modal after 3 seconds
            setTimeout(() => {
                closePurchaseModal();
                document.getElementById('emailForm').style.display = 'block';
            }, 3000);
        });

        // Close modal when clicking outside
        document.getElementById('purchaseModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closePurchaseModal();
            }
        });

        // Initial population of courses
        populateCourses();
    </script>
</body>
</html>
